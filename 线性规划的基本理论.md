## 线性规划的基本理论

#### 标准型和对偶

+ 线性规划的标准型：
<p align="center">  $\max \pmb{c}^\mathrm{T}\pmb{x}$ </br> $\pmb{A}\pmb{x} \le \pmb{b}$ </br>  $\pmb{x} \ge \pmb{0}$</p>

+ 它的对偶问题为：
<p align="center">  $\min \pmb{b}^\mathrm{T}\pmb{y}$ </br> $\pmb{y}^\mathrm{T}\pmb{A} \ge \pmb{c}^\mathrm{T}$ </br> $\pmb{y} \ge \pmb{0}$ </p>

+ 对偶问题的一种理解方式：
  >用系数 $ y_i$ 去乘每一个限制，来凑出不小于目标函数的函数。

+ 对于“更一般”的线性规划：
<p align="center">  $\max \pmb{c}^\mathrm{T}\pmb{x}$ </br> $\pmb{A}\pmb{x} = \pmb{b}$ </br>  $\pmb{x} \ge \pmb{0}$</p>

+ 其对偶问题为：
<p align="center">  $\min \pmb{b}^\mathrm{T}\pmb{y}$ </br> $\pmb{y}^\mathrm{T}\pmb{A} \ge \pmb{c}^\mathrm{T}$ </p>

#### 相关定理

+ 弱对偶定理：若 $\pmb{x}$ 是原问题（极大化）的可行解，$y$ 是对偶问题（极小化）的可行解，那么 $\pmb{c}^\mathrm{T}\pmb{x} \le \pmb{b}^\mathrm{T}\pmb{y}$。
	- 证明1：按上述的理解可直接推出
	- 证明2：$\pmb{c}^\mathrm{T}\pmb{x} \le \pmb{y}^\mathrm{T}\pmb{A} \pmb{x} \le \pmb{y}^\mathrm{T}\pmb{b}$

+ 强对偶定理：如果原问题（极大化）与对偶问题（极小化）之一有最优解，则另一个也有最优解，且目标函数值相同。

#### 一道例题

+ 题目：$n$ 个点 $m$ 条边的图，边权均为正数。用线性规划表示 $s$ 到 $t$ 的最短路长度。
+ 做法：设 $\pmb{x}$ 是 $n$ 维的变量。如果是无向图，将每条边拆成两条有向边。
<p align="center">  $\max \pmb{x}_t$ </br> $\forall e=(u \rightarrow v,w) ~~~ \pmb{x}_v  \le \pmb{x}_u + w$ </br>  $\pmb{x} \ge \pmb{0},\pmb{x}_s=0$ </p>

+ 证明：
	1. 找到 $s$ 到 $t$ 的任意一条最短路。向量 $\pmb{f}$ 满足：$\pmb{f}_i$ 是这条最短路从 $s$ 到 $i$ 经过的边的权值和，同时记 $F=\pmb{f}_t$.
	2. 设向量 $\pmb{g}$ 是该线性规划取到最大值时对应的一组解，记 $G$ 为最大值。
	3. 因为 $\pmb{f}$ 表示一条最短路，由最短路性质，我们发现 $\pmb{f}$ 是满足上述线性规划限制的一组可行解。由 $\pmb{g}$ 是一组最优解，所以 $F \le G$.
	4. 现在只需证明 $F \ge G$ 即可说明 $F=G$。反证，假设 $F < G$.
	5. 由 $\pmb{f}_s \ge \pmb{g}_s=0,\pmb{f}_t < \pmb{g}_t$，$\pmb{f}$ 表示的最短路径上必然存在一条边 $e=(u \rightarrow v,w)$，满足 $\pmb{f}_u \ge \pmb{g}_u,~\pmb{f}_v < \pmb{g}_v$. 所以 $\pmb{f}_v-\pmb{f}_u < \pmb{g}_v - \pmb{g}_u$.
	6. 因为 $\pmb{f}$ 表示最短路径，所以 $\pmb{f}_v-\pmb{f}_u=w$，即 $\pmb{g}_v-\pmb{g}_u>w$，这和 $\pmb{g}$ 是该线性规划的一组可行解矛盾。所以假设不成立，即 $F \ge G$。
	7. 最终我们得到 $F=G$，原命题得证。