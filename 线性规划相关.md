## 线性规划的基本理论

#### 凸集、凸函数、线性规划的定义

+ [链接](https://www.cnblogs.com/tsreaper/p/aop1.html)
+  “最优解一定可以在极点取到” 的补充证明：
	1. 假设最优点 $O$ 严格在凸集里面。取任意一条经过它的直线，设它与凸集的交点是 $P,Q$。因为是线性规划问题，$O$ 点处的函数值一定是 $P$ 和 $Q$ 的线性组合。所以我们可得，$P$ 和 $Q$ 中，至少有一处的函数值是大于等于 $O$ 的（如果相等，那么这个凸集其实已经退化了）。
	2. 我们可以重复上述步骤，把最优点一步一步约束到顶点上。比如在三维的例子中，我们先将其“规约”到凸壳的表面上，最后“规约”到凸壳的边和点上。

#### 单纯形法

+ [链接](https://www.cnblogs.com/tsreaper/p/aop2.html)
+ 单纯形法的一些直观感受
	- 变换的本质是：在满足约束的限制下，用不同的**非基变量**组合来表示目标函数。
	- 当非基变量的检验值均 $\le 0$ 时取到最大值。我们可以想象成，目标函数就是由这些非基变量决定的，它们目前都取了 $0$，而且任意变量的微小增长都会导致结果变劣。
	- 步骤
		1. 将 $A$ 中的**基变量**消成单位矩阵，并把目标函数**基变量**的系数都消成 $0$。
		3. 如果检验数均 $\le 0$ 就结束；否则找一个 $c_j>0$ 的**非基变量** $j$ **入基**：依次考察每一行，找到 $b_i > 0$ 且 $\frac{b_i}{A_{i,j}}$ 最小的 $j$.
		4. 将第 $i$ 行的**基变量**出基：拿第 $i$ 行去消，把每一行的 $A_{k,j}$ 以及目标函数的 $c_j$ 都消成 $0$。之后重复步骤 $3$.



#### 一道例题

+ 题目：$n$ 个点 $m$ 条边的图，边权均为正数。用线性规划表示 $s$ 到 $t$ 的最短路长度。
+ 做法：设 $\pmb{x}$ 是 $n$ 维的变量。如果是无向图，将每条边拆成两条有向边。
<p align="center">  $\max \pmb{x}_t$ </br> $\forall e=(u \rightarrow v,w) ~~~ \pmb{x}_v  \le \pmb{x}_u + w$ </br>  $\pmb{x} \ge \pmb{0},\pmb{x}_s=0$ </p>

+ 证明：
	1. 找到 $s$ 到 $t$ 的任意一条最短路。向量 $\pmb{f}$ 满足：$\pmb{f}_i$ 是这条最短路从 $s$ 到 $i$ 经过的边的权值和，同时记 $F=\pmb{f}_t$.
	2. 设向量 $\pmb{g}$ 是该线性规划取到最大值时对应的一组解，记 $G$ 为最大值。
	3. 因为 $\pmb{f}$ 表示一条最短路，由最短路性质，我们发现 $\pmb{f}$ 是满足上述线性规划限制的一组可行解。由 $\pmb{g}$ 是一组最优解，所以 $F \le G$.
	4. 现在只需证明 $F \ge G$ 即可说明 $F=G$。反证，假设 $F < G$.
	5. 由 $\pmb{f}_s \ge \pmb{g}_s=0,\pmb{f}_t < \pmb{g}_t$，$\pmb{f}$ 表示的最短路径上必然存在一条边 $e=(u \rightarrow v,w)$，满足 $\pmb{f}_u \ge \pmb{g}_u,~\pmb{f}_v < \pmb{g}_v$. 所以 $\pmb{f}_v-\pmb{f}_u < \pmb{g}_v - \pmb{g}_u$.
	6. 因为 $\pmb{f}$ 表示最短路径，所以 $\pmb{f}_v-\pmb{f}_u=w$，即 $\pmb{g}_v-\pmb{g}_u>w$，这和 $\pmb{g}$ 是该线性规划的一组可行解矛盾。所以假设不成立，即 $F \ge G$。
	7. 最终我们得到 $F=G$，原命题得证。